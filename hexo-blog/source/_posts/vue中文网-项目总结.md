---
title: '[vue中文网]项目总结'
date: 2018-01-23 13:45:44
tags: 项目总结
---

项目内容：vue中文网<br>
项目地址：[github地址](https://github.com/xuelinglong/Chinese-community)<br>
预览地址：[demo](https://xuelinglong.github.io/Chinese-community/#/)

# 实现功能
* 滚动加载
* 下拉刷新
* 登录、登出
* 收藏、取消收藏
* 发布新topic
* 评论、评论点赞
<!-- more -->

# 项目过程
## 主题页模块
包含一个菜单和一个content列表，contentlist里面每个元素都是同样的样式，因此写一个公共的list组件，以菜单选中的值作为区分，元素为card组件，以每个主题不同的id作为区分。

## 消息页模块
登录前显示提示登录，确定后跳转到登录页面登录，登录后显示已读与未读消息。

## 用户页模块
登录前显示登录页面，确定后跳转到登录页面登录，登录后显示用户信息，包含收藏、参与、最近的话题、并可跳转到usertopics。

## 详情页模块
显示某个主题的详细信息，以id为参数获取到数据，可从多处跳转到详情页，如：主题页的某个主题、usertopics列表中的主题、消息列表中的某个消息。未登录时点击收藏按钮提示用户自主登录，登录之后判断用户是否收藏，然后判断进行*收藏*或者*取消收藏*中的哪个操作。

## 发布模块
登录前显示提示登录页面，确定后跳转到登录页面登录，登录后可以发布主题，选择类别，写上标题，书写正文，*标题长度大于10*且*正文不为空*，则可发布。

## 评论页模块
主体为评论列表，显示目前所有的评论信息，登录前点击上方评论框或者点赞按钮提示用户自主登录，登录之后才可进行*发表评论*和*为他人的评论点赞*功能。

## usertopics模块
主体为topics列表，以跳转时的title参数来区分，此区域的topics列表与首页（即主题页模块）的contentlist列表*样式不同*且没有带*下拉刷新*，其实也可以写的一样。

# 遇到的重难点
## 跨域
出现 “axios.get传参数时拼接为post方法” 错误时耗费了很多时间找解决方案：
axios.post后面的URL写死，可以获取正确使用post方法，但是一旦URL中间需要参数自己匹配，那么就继续报错。

在这个时候猛然想到我最初开始项目时配置了 config/index中的proxyTable，也就是解决跨域，这是因为再上一个项目的时候因为跨域问题所以配置了，本次项目开始时没有确认是否跨域就配置了，找了好久的bug就在这里。

*协议、端口、域名*只要有一个不同就确定了要跨域，若全部相同则不需要跨域。<br>
以本次API为例：

| describe | url | 同源情况 |
| -------- | --- | ------- |
| 数据网址 | `https://www.vue-js.com/api/` | null |
| baseURL | `https://www.vue-js.com/api/v1/` | null |
| 主题首页 | `baseURL/topics` | 同源 |


以豆瓣API为例：

| describe | url | 同源情况 |
| -------- | --- | ------- |
| 数据网址 | `https://api.douban.com/api/v2/movie/in_theaters` | null |
| 正在热映 | `localhost:8080/api/v2/movie/in_theaters` | 域名不同 |
| 配置api/后 | `https://api.douban.com/api/v2/` | 同源 |

最初使用axios的时候要区分好本次项目是否跨域，只有确定跨域的话才能配置config/index中的proxyTable解决跨域
```
    proxyTable: {
      '/api': {
        target: 'http://xxxxx/xx',
        changeOrigin: true,
        pathRewrite: {
          '^/api': '',
        },
      }
    }
```

## 自由组合的设计思想
每个组件是一个单独的模块，应该具有自己特定的功能，不管页面如何组合，所有的功能都应该可以正确使用。<br>
项目中的例子：
list区域包含许多card，此区域应具有 *下拉刷新* 和 *滑动加载* ，这应该是list区域特有的功能，无论list区域放到哪个页面，都不应该影响这2个功能的使用，最初我把这两个功能写在了list的父容器上面，如果把list区域放在别的页面那么这两个功能就不能使用了，这是不合逻辑的，经过改正我对这个问题有了更深的理解。

## 组件的生命周期
| cycle | describe | 生命周期钩子的使用方法 |
| ----- | -------- | ------------------ |
| beforeCreate | 组件实例刚刚被创建，属性都没有 | 可以在这加个loading事件，在加载实例时触发 |
| created | 实例已经创建完成，属性已经绑定，但是DOM还没有生成 | 初始化完成时的事件写在这里，如在这结束loading事件，异步请求也适宜在这里调用 |
| beforeMount | 模板编译之前 |  |
| mounted | 模板编译完成，之前的 ready 变成了现在的 mounted | 挂载元素，获取到DOM节点 |
| beforeUpdate | 组件更新之前 | 如果对数据统一处理，在这里写上相应函数 |
| updated | 组件更新完毕 |
| beforeDestroy | 组件销毁之前 | 可以做一个确认停止事件的确认框 |
| destroyed | 组件销毁后 |

# 收获
## vuex管理状态应该分清楚modules，避免混乱
* topics：包含获取不同tab、page、limit的数据
* messages：用户的已读、未读消息、标记全部已读功能
* info：包含详情页、评论页、收藏功能、点赞功能
* push：发布新主题功能
* login：登录、登录后获取用户数据

## 学会在GitHub上记录issue
出现问题可是open一个issue，记录一下自己的思考过程和解决方案，拉取一个分支解决这个问题，确保无误后再合并到master上，这样的话就会对问题有一个清晰的把控，并且记忆深刻。

## 学会使用Eslint
ESLint 可以帮助我们在编码的过程中发现问题，使用了Eslint的代码逻辑也比较清晰，有一个良好的代码风格还是很重要的。
