---
title: '2018-01-06'
date: 2018-01-06 00:05:50
tags: 周报
---

# 本周做的事
恢复系统、处理ssh连接问题、完善博客仓库、学习了一点点js单步调试。

# 遇到的困难
## ssh连接报错
恢复系统之后git push 一直不成功。
```
ssh_exchange_identification: Connection closed by remote host
```

在解决这个问题的过程中又对ssh有了更深的了解，先说一下我最初的ssh配置过程：
```
$ cd ~/.ssh

// xxxx@xxxx.com为我注册GitHub的邮箱
$ ssh-keygen -t rsa -C "xxxx@xxxx.com"

$ cat id_rsa.pub
// 拷贝id_rsa.pub的内容到github的setting中添加新的SSH KEY
// 查看到邮件即为添加成功

$ ssh git@github.com
// 这是连接成功时的显示
Hi username! You've successfully authenticated, but GitHub does not provide shell access.
// 我真实显示的内容，连接失败，此原因可以通过改为443端口解决
ssh: connect to host github.com port 22: Operation timed out

// 更改为443端口的配置过程：~/.ssh中添加config文件，文件内容：
Host github.com
  hostname ssh.github.com
  Port 443
$ ssh -T git@github.com      // 成功的标志与上面类似
```
查找了很多方法还是没能解决这个问题，最后求助别人才知道可以切换为https协议，切换之后就能正常提交代码了。
<!-- more -->
### 收获
我又重新学习了创建ssh的过程，在这个过程中发现了几点之前不知道的地方。
1. ` ssh-keygen -t rsa -C "xxxx@xxxx.com" `命令之后不能一路回车（第一次除外）因为一路回车的话代表着不起名字，不设密码，默认生成` id_rsa `和` id_rsa.pub `密钥对，如果不是第一次执行这个命令，那么新生成的密钥会覆盖之前生成的，这就会造成当前` id_rsa `与我们之前已经添加到GitHub上面的` id_rsa.pub `不匹配。
2. 除了ssh还有https协议可以使用，我还是对于git的使用了解的太少了，如果本来就知道这个的话完全可以先切换成https协议使用着，等后面在查找问题也可以，因此我发自己需要好好学习关于git的使用。


## 博客源文件与静态文件分开
最初把博客迁移到Mac上面时是只生成了一个hexo根目录，里面的 _config.yml、scaffolds、source、themes、node_modules等文件都是从原电脑上拷贝过来的，这样就弄的特别麻烦，本次ssh连接接出问题之后查找了一些关于这方面的博客，发现了别人说的博客仓库使用两个分支：master存放静态网页，hexo存放源文件，那么下次再更换电脑的话就可以直接从远程仓库克隆然后再配置，这种方法比起拷贝文件真的是好太多了，所以就逐步摸索了一下此方案，以下是我摸索的过程：

1. 克隆远程博客仓库到本地：` git clone https;//github.com/xxx/xxx.git `；
2. 进入到仓库文件夹里面把本地 master 分支与远程 master 分支 同步：` git pull origin master:master `；
3. 新建一个本地 hexo 分支并切换到 hexo 分支： ` git checkout -b hexo `;
4. 把本地 hexo 分支与远程 master 分支同步：` git pull origin master:hexo `;
5. 把之前迁移之时的hexo根目录拷贝到此仓库下
6. ` git add hexo-blog   // hexo-blog是我的hexo根目录文件夹名称 `;
7. ` git commit -m "xxx" `;
8. ` git push origin hexo `;

但是到现在还有些疑惑：
1. 克隆完博客仓库之后不能进行npm instll操作，错误信息是没有package.json文件，这是为什么？
2. 有点想不明白远程的hexo分支是为了存放博客源文件，那么需不需要把之前master上面的提交同步到hexo分支上，虽然我已经做过这一步了，但是现在感觉之前master上面都是博客的静态网页，那么hexo应该不需要关心这些，只要把源文件上传上去就好了吧。


## https与ssh
https协议：每个访问Git仓库的人都可以使用https协议进行克隆操作，此方式进行` git push `时每次都要输入用户名密码。

ssh协议：不管想使用SSH进行克隆或提交中的任何一个操作，那么我们必须是项目的拥有者，如果不是项目的拥有者同时也想使用SSH进行读写操作的话，必须在仓库中添加的有与自己相对应的公钥。但是想拥有对仓库的写权限就必须使用SSH，这是一种更加安全的访问方式。

### 将https转变为SSH
1. 生成公私密钥对
2. 公钥添加到github上
3. ` ssh git@github.com `验证是否添加成功
4. 保存代码最后一次的修改并提交
5. 删除项目
6. 使用ssh方式克隆项目：` git clone git@github.com:用户名/仓库名.git `
7. 修改https：` git remote set-url origin git@github.com:用户名/仓库名.git `  (最重要的一步，前面的步骤可省略，后面即为ssh的url)

### 将ssh转变为https
1. 查看远程库信息：` git remote -v `
2. 移除远程库：` git remote rm origin `
3. 添加远程仓库：` git remote add origin https://xxxxxx `


### https与ssh互换总结起来为两步
1. 修改命令：` git remote set-url origin [url] ` url的类型要分清楚!!!
2. 仓库先删后加：` git remote rm origin ` ` git remote add [url] `url的类型要分清楚!!!
