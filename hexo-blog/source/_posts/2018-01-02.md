---
title: '2018-01-02'
date: 2018-01-02 14:49:34
tags: 周报
---

# 本周做的事
下拉刷新、收藏、修复小细节的问题。

# 解决的问题
## 登录以后获取到已收藏的话题，把他们与未收藏的话题做区分；
写一个isCollected属性来控制话题是否被收藏，判断是否被收藏的标志是：把当前topic_id与获取到的用户数据中collect_topics中每一项的id做对比，有一致的就触发让isCollected=true的action，若没有一致的就触发让isCollected=false的action。

## 发布新主题时输入content内容时如何使用markdown语法；
不需要关心是否能显示markdown语法，上传数据时网站会自动把content中的内容转换，因此项目中只要能正确发布新主题即可。
<!-- more -->
## axios.post();
url需要使用参数拼接时，怎么不让拼接错为get方法：
跨域：只要协议、域名、端口有任何一个不同，都被当作是不同的域，此时才是跨域访问。
上个项目的时候要配置跨域，我没有研究跨域的真正含义，在本次项目开始时就配置了config/index.js中的proxytable,所以在项目过程中每次使用axios.post(),只要传参数而不是写死网址，那么就一定会拼接为get方法，一直到后来没办法写死网址之时才意识到这个问题真的很严重。

## 滑动加载；
错误表现：此时会在未滑动时执行一次loadmore。
可以在函数中加入一个判断，最初数据数组长度为0，此时不执行loadmore，只有在数据的数组长度不为0时才能执行loadmore。

## header应该是固定在顶部的；
未登录时首页header固定在顶部，登录账号以后，header位置就不固定了，向下滑动时header会向上隐藏。
把header和tab全部写为fixed，固定值。

# 遇到的问题
## 跳转到主题详情页时不能保存跳转之前的状态;
错误表现一：若首页向下滑动一部分再点击主题进入详情页，那么在详情页点击返回按钮之后会跳转到首页最上方。
错误表现尔：若先切换菜单至xx(“全部” 之外的5个之一)，然后选中一个主题进入详情页，那么在详情页点击返回按钮之后仍会跳转到首页（topics---全部）最上方。

## 提示用户登录时的自动跳转到登录页面；
未登录时msg,push显示有提示登录的按钮，点击之后应该自动跳转到 my页面登录.

## 滑动加载到数据库中没有数据后滑动就混乱了；
想法是判断本次是否加载到数据，如果没有加载到数据的话就扔掉loadmore函数，可是要怎么删去这个函数呢，没想到方法。

## 单步调试；
selected的值对应着当前显示哪个界面，登录之后 -> 点击收藏的话题（或者参与、最近的话题） -> 然后点击左上角返回，此时应该返回到 “登录后的my页面”，但目前的情况是返回到首页。
这个问题需要单步调试看是过程中怎么改变了selected的值，目前单步调试仍然没有学会。

## 文件格式化；
安装了Beautify、ESLint、vetur等几个插件后：option+shift+f格式化以后代码成一堆了，不是以前那种大括号包着层级分明的了。

## 控制台报错；
```
TypeError: Cannot read property 'avatar_url' of undefined
```

```
export default {
    state: {
        topics: {
            data: [],
            topicsubject: {
                sub: {
                    author: {
                        avatar_url: '',
                        loginname: ''
                    },
                    author_id: '',
                    content: '',
                    create_at: '',
                    id: '',
                    last_reply_at: '',
                    replies: [],
                    reply_count: 0,
                    tab: '',
                    title: '',
                    top: false,
                    visit_count: 0
                },
                isCollected: false
            }
        },
        page: 0,
        loading: false
    },
    mutations,
    actions
};
```
vuex中定义了这个属性，组件中直接获取sub使用，src匹配为sub.authou.avatar_url,然后控制台报错。

# 收获
经过本周的学习，发现了很多不足之处：
1. 应该多思考，出现问题就应该发散思维想想，有些问题可以有很多方法解决，哪怕是最笨的方法只要把问题解决了都可以，可以在以后的过程中摸索更好的解决办法；
2. vuex各模块之间命名弄得比较乱；
3. 同样的页面只要用一个就行了，代码维护性要考虑到；
4. 缺少对vue插件的使用学习。
5. 代码不规范，以后学习三方库要多研究人家给的介绍和demo，养成好的代码习惯。

