---
title: 周报一
date: 2017-12-17 19:49:44
tags: 周报
---

# 本周做的事
topic，my两个模块。

# 遇到的问题
## mint-ui使用错误；
此问题非自己检查出来的，mint-ui有官方文档和代码库和demo，结合着看才能知道究竟怎么使用。
## 页面逻辑；
开始时更改过一次页面逻辑，后面发现其实不用刻意的写页面逻辑，每个页面都是一个单独的vue文件，页面间应该是可以自由组合的，因此我在此方面耗费了太长时间。
<!-- more -->
## axios库；
get方法：
```
const HOST = 'https://www.vue-js.com/api/v1/'
[type.FETCH_TOPICS](context, payload) {
        axios.get(HOST + `topics`, {
            params: {
                tab: payload.tab,
                page: payload.page,
                limit: payload.limit
            }
        }).then(res => {
            let DATA = res.data.data;
            let arr = context.state.topics.data.concat(DATA);
            if (DATA.length > 0) {
                context.commit(type.FETCH_TOPICS, {
                    data: arr
                });
            }
        }).catch(err => console.log(err));
    }
    // 拼接为：https://www.vue-js.com/api/v1/topics?tab=xxx&page=xxx&limit=xxx
```
## 用户登录；
post /accesstoken 验证 accessToken 的正确性;

接收 post 参数:
accesstoken  String  用户的 accessToken, 如果成功匹配上用户，返回成功信息。否则 403。

返回值示例:  {success: true, loginname: req.user.loginname}

```
type.LOGIN_USER](context, payload) {
        axios({
            method: 'post',
            url: HOST + 'accesstoken',
            params: {
                accesstoken: payload.accesstoken
            }
        }).then(res => {
            context.commit(type.LOGIN_USER, {
                data: res.data
            });
        }).catch(err => console.log(err));
    }
```
post方法会报错：
```
// 1.
Request URL:http://localhost:4040/api/accesstoken?accesstoken=2cf09343-2162-48c8-88aa-bba001aa155d
Request Method:GET
Status Code:301 Moved Permanently

// 2.
Request URL:http://localhost:4040/api/accesstoken?accesstoken=2cf09343-2162-48c8-88aa-bba001aa155d
Request Method:POST
Status Code:301 Moved Permanently

// 3.
Request URL:https://www.vue-js.com/api/v1/accesstoken?accesstoken=2cf09343-2162-48c8-88aa-bba001aa155d
Request Method:GET
Status Code:404 Not Found
```
此问题未解决。

## 滑动加载；
```
        <mt-tab-container v-model="selected"
            v-infinite-scroll="loadMore"
            infinite-scroll-disabled="loading"
            infinite-scroll-distance="10">

            <mt-tab-container-item id="all">
                <v-list :tabName="selected" :subjects="subjects"></v-list>
            </mt-tab-container-item>
            <mt-tab-container-item id="good">
                <v-list :tabName="selected" :subjects="subjects"></v-list>
            </mt-tab-container-item>
            <mt-tab-container-item id="weex">
                <v-list :tabName="selected" :subjects="subjects"></v-list>
            </mt-tab-container-item>
            <mt-tab-container-item id="share">
                <v-list :tabName="selected" :subjects="subjects"></v-list>
            </mt-tab-container-item>
            <mt-tab-container-item id="ask">
                <v-list :tabName="selected" :subjects="subjects"></v-list>
            </mt-tab-container-item>
            <mt-tab-container-item id="job">
                <v-list :tabName="selected" :subjects="subjects"></v-list>
            </mt-tab-container-item>
            
            <p v-show="loading" class="page-infinite-loading">
                <mt-spinner type="fading-circle"></mt-spinner>
                加载中...
            </p>
        </mt-tab-container>
<script>
export default {
    data() {
      return {
        loading: false,
        allLoaded: false,
        wrapperHeight: 0
      };
    },
    methods: {
        loadMore() {
            this.loading = true;
            this.page += 1;
            this.fetch(this.selected, this.page, 20);
            this.loading = false;
            console.log('* loadMore被触发了👩‍❤️‍👩👩‍❤️‍👩👩‍❤️‍👩');
        }
    }
</script>
```
错误表现：此时会在未滑动时执行两次loadmore。

## 布局；
header和tabbar的宽度明显不同，目前不理解浏览器中iPhone7手机模式（375*667）预览时，为什么body的宽度是359，中间的宽度差是怎么回事。

# 收获
经过本周的学习，现在对获取API伤的数据更加熟练，但是发现自己的代码少了很多必须的东西，比如说：
1.点击登录按钮后应该添加一个加载中的页面作为中转状态；
2.获取数据失败时如何处理错误信息；
3.可以写一个js文件用来存储cookies等。